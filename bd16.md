## volatile关键字，如果有两个线程同时增加变量 i，为什么各执行了100次，结果不是 i = 200？

1. 原因：volatile 不保证原子性。

2. 原子性的含义：一个操作是不可中断的，要么全部执行成功要么全部执行失败。即多个线程一起执行的时候，一个操作一旦开始，就不会被其他线程所干扰。。

3. 具体解释：因为当线程 A 对 i++ 操作从自己的工作内存刷新到主内存时，还未通知到其他线程主内存变量有更新的瞬间，其他线程对 i 变量的操作结果也对主内存进行了刷新，从而导致了写值丢失的情况。（从汇编指令分析得，i++ 被拆成了三个步骤，读、写、改）

4. 解决办法：加 sync，锁住增加变量 i 的功能函数。