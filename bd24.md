## 为什么连接建立需要三次握手，而不是两次握手？ 
---

防止失效的连接请求报文段被服务端接收，从而产生错误。若建立连接只需两次握手，客户端并没有太大的变化，仍然需要获得服务端的应答后才进入ESTABLISHED状态，而服务端在收到连接请求后就进入ESTABLISHED状态。此时如果网络拥塞，客户端发送的连接请求迟迟到不了服务端，客户端便超时重发请求，如果服务端正确接收并确认应答，双方便开始通信，通信结束后释放连接。此时，如果那个失效的连接请求抵达了服务端，由于只有两次握手，服务端收到请求就会进入ESTABLISHED状态，等待发送数据或主动发送数据。但此时的客户端早已进入CLOSED状态，服务端将会一直等待下去，这样浪费服务端连接资源。

或者说。。

因为我们不进行第三次握手，所以在Server对Client的请求进行回应(第二次握手)后，就会理所当然的认为连接已建立，而如果Client并没有收到Server的回应呢？此时，Client仍认为连接未建立，S会对已建立的连接保存必要的资源，如果大量的这种情况，Server会崩溃。

## 为什么不是四次握手？
---

四次握手其实也能够可靠的同步双方的初始化序号，但由于第二步和第三步可以优化成一步，所以就成了「三次握手」。

四次握手的中间两次是可以合并的，合并之后就是三次握手，还提升了连接效率

因为完全可靠的通信协议是根本不存在的，我们任何的通信协议都是在接受这样的现实情况之上进行的。

而三次握手后，Client和Server至少可以确认之前的通信情况，但无法确认之后的情况。

在这个道理上说，无论是四次还是五次或是更多次都是徒劳的。

总的来说，三次握手就是一个理论上既保证了传输的可靠性，又保证了建立连接效率的最小握手次数。