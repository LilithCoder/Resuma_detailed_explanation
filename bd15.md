## C++ 中的 volatile 关键字

C/C++ 中的 volatile 关键字和 const 对应，用来修饰变量

volatile 关键字是一种类型修饰符，用它声明的类型变量表示可以被某些编译器未知的因素更改

volatile 指出 i 是随时可能发生变化的

当要求使用 volatile 声明的变量的值的时候，系统总是重新从它所在的内存读取数据，即使它前面的指令刚刚从该处读取过数据。

遇到这个关键字声明的变量，编译器对访问该变量的代码就不再进行优化，从而可以提供对特殊地址的稳定访问。

没有用volatile关键字声明的变量i在被访问的时候可能直接从cpu的寄存器中取值（因为之前i被访问过，也就是说之前就从内存中取出i的值保存到某个寄存器中），之所以直接从寄存器中取值，而不去内存中取值，是因为编译器优化代码的结果（访问cpu寄存器比访问ram快的多）。

精确地说就是，优化器在用到这个变量时必须每次都小心地重新读取这个变量的值，而不是使用保存在寄存器里的备份。

### 下面是volatile变量的几个例子：

- 并行设备的硬件寄存器（如：状态寄存器）

- 一个中断服务子程序中会访问到的非自动变量(Non-automatic variables)

- 多线程应用中被几个任务共享的变量